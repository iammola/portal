#!/bin/sh

RED="\033[1;31m";
GREEN="\033[1;32m";

FILES=$(git diff --cached --diff-filter=d --name-only | grep  -E '\.(?:t|j)sx?$');

# skip if there are no files
[ -z "$FILES" ] && exit 0;

# run linter and prettier on staged files
./node_modules/.bin/eslint $FILES --quiet && ./node_modules/.bin/prettier $FILES --ignore-unknown --write;

# save exit code
linter_exit_code=$?;

# check the linter exit code
if [ $linter_exit_code -ne 0 ]; then
    echo "${RED} ❌ You have linter errors in your code. 🤦‍♂️";
    exit 1;
fi

echo "${GREEN} 👍 Good coder. No errors found 😁";
exit 0;
